#
# Makefile generated by fpcmake v0.99.13 on 1999-11-24 23:13
#

defaultrule: all

#####################################################################
# Autodetect OS (Linux or Dos or Windows NT)
# define inlinux when running under linux
# define inWinNT when running under WinNT
#####################################################################

# We need only / in the path
override PATH:=$(subst \,/,$(PATH))

# Search for PWD and determine also if we are under linux
PWD:=$(strip $(wildcard $(addsuffix /pwd.exe,$(subst ;, ,$(PATH)))))
ifeq ($(PWD),)
PWD:=$(strip $(wildcard $(addsuffix /pwd,$(subst :, ,$(PATH)))))
ifeq ($(PWD),)
nopwd:
	@echo You need the GNU utils package to use this Makefile!
	@echo Get ftp://ftp.freepascal.org/pub/fpc/dist/go32v2/utilgo32.zip
	@exit
else
inlinux=1
endif
else
PWD:=$(firstword $(PWD))
endif

# Detect NT - NT sets OS to Windows_NT
ifndef inlinux
ifeq ($(OS),Windows_NT)
inWinNT=1
endif
endif

# Detect OS/2 - OS/2 has OS2_SHELL defined
ifndef inlinux
ifndef inWinNT
ifdef OS2_SHELL
inOS2=1
endif
endif
endif

# The extension of executables
ifdef inlinux
EXEEXT=
else
EXEEXT=.exe
endif

# The path which is search separated by spaces
ifdef inlinux
SEARCHPATH=$(subst :, ,$(PATH))
else
SEARCHPATH=$(subst ;, ,$(PATH))
endif

#####################################################################
# FPC version/target Detection
#####################################################################

# What compiler to use ?
ifndef FPC
ifdef inOS2
export FPC=ppos2$(EXEEXT)
else
export FPC=ppc386$(EXEEXT)
endif
endif

# Target OS
ifndef OS_TARGET
export OS_TARGET:=$(shell $(FPC) -iTO)
endif

# Source OS
ifndef OS_SOURCE
export OS_SOURCE:=$(shell $(FPC) -iSO)
endif

# Target CPU
ifndef CPU_TARGET
export CPU_TARGET:=$(shell $(FPC) -iTP)
endif

# Source CPU
ifndef CPU_SOURCE
export CPU_SOURCE:=$(shell $(FPC) -iSP)
endif

# FPC version
ifndef FPC_VERSION
export FPC_VERSION:=$(shell $(FPC) -iV)
endif

#####################################################################
# Default Settings
#####################################################################

# Release ? Then force OPT and don't use extra opts via commandline
ifdef RELEASE
override OPT:=-Xs -OG2p3 -n
endif

# Verbose settings (warning,note,info)
ifdef VERBOSE
override OPT+=-vwni
endif

#####################################################################
# User Settings
#####################################################################


# Targets

DIROBJECTS+=$(wildcard fake text)

# Clean


# Install


# Defaults


# Directories

ifndef PACKAGEDIR
PACKAGEDIR=$(FPCDIR)/packages
endif

# Packages


# Libraries


#####################################################################
# Default rules
#####################################################################

.PHONY: defaultrule all debug examples test smart shared \
	showinstall install zipinstall zipinstalladd \
	clean cleanall depend info

debug: $(addsuffix _debug,$(DIROBJECTS))

examples: $(addsuffix _examples,$(DIROBJECTS))

test: $(addsuffix _test,$(DIROBJECTS))

smart: $(addsuffix _smart,$(DIROBJECTS))

shared: $(addsuffix _shared,$(DIROBJECTS))

showinstall: $(addsuffix _showinstall,$(DIROBJECTS))

install: $(addsuffix _install,$(DIROBJECTS))

zipinstall: $(addsuffix _zipinstall,$(DIROBJECTS))

zipinstalladd: $(addsuffix _zipinstalladd,$(DIROBJECTS))

clean: $(addsuffix _clean,$(DIROBJECTS))

cleanall: $(addsuffix _cleanall,$(DIROBJECTS))

depend: $(addsuffix _depend,$(DIROBJECTS))

info: $(addsuffix _info,$(DIROBJECTS))


# Dir fake

fake_all:
	$(MAKE) -C fake all

fake_debug:
	$(MAKE) -C fake debug

fake_examples:
	$(MAKE) -C fake examples

fake_test:
	$(MAKE) -C fake test

fake_smart:
	$(MAKE) -C fake smart

fake_shared:
	$(MAKE) -C fake shared

fake_showinstall:
	$(MAKE) -C fake showinstall

fake_install:
	$(MAKE) -C fake install

fake_zipinstall:
	$(MAKE) -C fake zipinstall

fake_zipinstalladd:
	$(MAKE) -C fake zipinstalladd

fake_clean:
	$(MAKE) -C fake clean

fake_cleanall:
	$(MAKE) -C fake cleanall

fake_depend:
	$(MAKE) -C fake depend

fake_info:
	$(MAKE) -C fake info


# Dir text

text_all:
	$(MAKE) -C text all

text_debug:
	$(MAKE) -C text debug

text_examples:
	$(MAKE) -C text examples

text_test:
	$(MAKE) -C text test

text_smart:
	$(MAKE) -C text smart

text_shared:
	$(MAKE) -C text shared

text_showinstall:
	$(MAKE) -C text showinstall

text_install:
	$(MAKE) -C text install

text_zipinstall:
	$(MAKE) -C text zipinstall

text_zipinstalladd:
	$(MAKE) -C text zipinstalladd

text_clean:
	$(MAKE) -C text clean

text_cleanall:
	$(MAKE) -C text cleanall

text_depend:
	$(MAKE) -C text depend

text_info:
	$(MAKE) -C text info

#####################################################################
# Users rules
#####################################################################

.PHONY: gdb full fullgdb clean_compiler

all:
	$(MAKE) -C text all

gdb:
	$(MAKE) -C text all GDB=1

full:
	$(MAKE) -C text all FULL=1 "NEEDOPT+=-Sg -dGDB -dBROWSERCOL"

fullgdb:
	$(MAKE) -C text all FULL=1 GDB=1 "NEEDOPT+=-Sg -dGDB -dBROWSERCOL"

#
# Misc
#
clean_compiler:
	make -C ../../compiler clean
